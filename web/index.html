<body>
  <script>
    var scriptLoaded = false;

    function loadMainDartJs() {
      if (scriptLoaded) return;
      scriptLoaded = true;
      var scriptTag = document.createElement('script');
      scriptTag.src = 'main.dart.js';
      scriptTag.type = 'application/javascript';
      document.body.append(scriptTag);
    }

    // ðŸ”¹ Unregister any existing service workers from older builds
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations()
        .then(function (regs) {
          for (let reg of regs) {
            reg.unregister();
          }
        })
        .catch(function (e) {
          console.warn('SW unregister failed', e);
        });
    }

    // ðŸ”¹ Always load the app directly on window load
    window.addEventListener('load', function () {
      loadMainDartJs();
    });
  </script>
</body>
